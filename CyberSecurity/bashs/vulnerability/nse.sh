#!/bin/bash
ip=$1
location=$2
output_file="$location/nse.txt"

# Run the Nmap scan and output to the specified file
sudo nmap -sS -sV -T4 --script=vulners --max-retries=10 --script-timeout=2m $ip -oN "$output_file"

# Create a temporary file for filtering
temp_file="$location/nseResult.txt"

# Use grep to filter out lines containing CVE, open, or vulners and store it in a temporary file
cat "$output_file" | grep -E "CVE|open|vulners:" > "$temp_file"

# Overwrite the original output file with the filtered contents
rm -f $output_file
