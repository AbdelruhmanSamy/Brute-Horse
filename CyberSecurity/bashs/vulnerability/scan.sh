#!/bin/bash
ip=$1
port=$2
location=$3
#check if any input is missing or not
if [[ -z "$ip" || -z "$port" || -z "$location" ]]; then
  echo "Usage: $0 <IP> <Port> <Location>"
  exit 1
fi
#Check if a Website is Running Using
if ! curl --connect-timeout 5 -s "http://$ip:$port" > /dev/null; then
  echo "Error: No website running at http://$ip:$port."
  exit 1
fi

new_location="$location/index.html"
mkdir -p "$location"  # Ensure the unique directory is created
wapiti -u "http://$ip:$port" -o $location
old_location=$(find "$location" -type f -name "*.html" -not -name "report.html" | head -n 1)
mv $old_location $new_location
 
